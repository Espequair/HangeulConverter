<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Korean Hangeul Practice</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-align: center;
            padding: 30px;
            position: relative;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .header p {
            opacity: 0.9;
            font-size: 1.1em;
        }

        .language-selector {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .language-selector label {
            font-size: 0.9em;
            opacity: 0.9;
        }

        .language-selector select {
            padding: 8px 12px;
            border: none;
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            font-size: 0.9em;
            cursor: pointer;
            backdrop-filter: blur(10px);
        }

        .language-selector select option {
            background: #495057;
            color: white;
        }

        .tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
        }

        .tab {
            flex: 1;
            padding: 20px;
            text-align: center;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 500;
            transition: all 0.3s ease;
            color: #6c757d;
        }

        .tab.active {
            background: white;
            color: #495057;
            border-bottom: 3px solid #667eea;
        }

        .tab:hover:not(.active) {
            background: #e9ecef;
        }

        .content {
            padding: 40px;
            min-height: 500px;
        }

        .practice-area {
            text-align: center;
            max-width: 600px;
            margin: 0 auto;
        }

        .word-display {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            border: 2px solid #e9ecef;
        }

        .prompt {
            font-size: 3em;
            font-weight: bold;
            margin-bottom: 15px;
            color: #495057;
        }

        .meaning {
            font-size: 1.3em;
            color: #6c757d;
            font-style: italic;
        }

        .input-area {
            margin-bottom: 30px;
        }

        .input-field {
            width: 100%;
            max-width: 400px;
            padding: 20px;
            font-size: 1.5em;
            border: 3px solid #e9ecef;
            border-radius: 10px;
            text-align: center;
            outline: none;
            transition: all 0.3s ease;
        }

        .input-field:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .feedback {
            margin-top: 20px;
            padding: 15px;
            border-radius: 10px;
            font-size: 1.2em;
            font-weight: 500;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .feedback.correct {
            background: #d4edda;
            color: #155724;
            border: 2px solid #c3e6cb;
        }

        .feedback.incorrect {
            background: #f8d7da;
            color: #721c24;
            border: 2px solid #f5c6cb;
        }

        .feedback.neutral {
            background: #fff3cd;
            color: #856404;
            border: 2px solid #ffeaa7;
        }

        .controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-primary:hover {
            background: #5a6fd8;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(108, 117, 125, 0.3);
        }

        .hidden {
            display: none !important;
        }

        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 300px;
            font-size: 1.2em;
            color: #6c757d;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 15px;
            }

            .header {
                padding: 20px;
            }

            .header h1 {
                font-size: 2em;
            }

            .language-selector {
                position: static;
                justify-content: center;
                margin-top: 15px;
            }

            .content {
                padding: 20px;
            }

            .prompt {
                font-size: 2.5em;
            }

            .tab {
                padding: 15px 10px;
                font-size: 1em;
            }

            .controls {
                flex-direction: column;
                align-items: center;
            }

            .btn {
                width: 100%;
                max-width: 300px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="language-selector">
                <label for="language-select" data-i18n="language_selector_label">Language:</label>
                <select id="language-select">
                    <option value="en" data-i18n="language_english">English</option>
                    <option value="fr" data-i18n="language_french">Français</option>
                </select>
            </div>
            <h1 data-i18n="title">Korean Hangeul Practice</h1>
            <p data-i18n="subtitle">Master Korean Hangeul and Romanization</p>
        </div>

        <div class="tabs">
            <button class="tab active" data-tab="hangeul-to-roman" data-i18n="tab_hangeul_to_roman">Hangeul → Romanization</button>
            <button class="tab" data-tab="roman-to-hangeul" data-i18n="tab_roman_to_hangeul">Romanization → Hangeul</button>
        </div>

        <div class="content">
            <div class="loading" id="loading">Loading...</div>
            
            <div id="hangeul-to-roman" class="tab-content hidden">
                <div class="practice-area">
                    <div class="word-display">
                        <div class="prompt" id="hangeul-prompt">가다</div>
                        <div class="meaning" id="hangeul-meaning">to go</div>
                    </div>
                    <div class="input-area">
                        <input type="text" class="input-field" id="hangeul-input" data-i18n-placeholder="placeholder_romanization" autocomplete="off">
                    </div>
                    <div class="feedback neutral" id="hangeul-feedback" data-i18n="instruction_check_romanization">
                        Type the romanization and click "Check Answer"
                    </div>
                    <div class="controls">
                        <button class="btn btn-secondary" id="hangeul-check" data-i18n="btn_check_answer">Check Answer</button>
                        <button class="btn btn-secondary" id="hangeul-show" data-i18n="btn_show_word">Show Word</button>
                        <button class="btn btn-primary" id="hangeul-next" data-i18n="btn_next_word">Next Word</button>
                    </div>
                </div>
            </div>

            <div id="roman-to-hangeul" class="tab-content hidden">
                <div class="practice-area">
                    <div class="word-display">
                        <div class="prompt" id="roman-prompt">gada</div>
                        <div class="meaning" id="roman-meaning">to go</div>
                    </div>
                    <div class="input-area">
                        <input type="text" class="input-field" id="roman-input" data-i18n-placeholder="placeholder_hangeul" autocomplete="off">
                    </div>
                    <div class="feedback neutral" id="roman-feedback" data-i18n="instruction_check_hangeul">
                        Type the Hangeul and click "Check Answer"
                    </div>
                    <div class="controls">
                        <button class="btn btn-secondary" id="roman-check" data-i18n="btn_check_answer">Check Answer</button>
                        <button class="btn btn-secondary" id="roman-show" data-i18n="btn_show_word">Show Word</button>
                        <button class="btn btn-primary" id="roman-next" data-i18n="btn_next_word">Next Word</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let vocabulary = [];
        let i18nData = {};
        let currentLanguage = 'en';
        let currentWordIndex = 0;
        let currentMode = 'hangeul-to-roman';

        // DOM elements
        const loading = document.getElementById('loading');
        const tabs = document.querySelectorAll('.tab');
        const tabContents = document.querySelectorAll('.tab-content');
        const languageSelect = document.getElementById('language-select');
        
        // Hangeul to Roman elements
        const hangeulPrompt = document.getElementById('hangeul-prompt');
        const hangeulMeaning = document.getElementById('hangeul-meaning');
        const hangeulInput = document.getElementById('hangeul-input');
        const hangeulFeedback = document.getElementById('hangeul-feedback');
        const hangeulCheck = document.getElementById('hangeul-check');
        const hangeulShow = document.getElementById('hangeul-show');
        const hangeulNext = document.getElementById('hangeul-next');
        
        // Roman to Hangeul elements
        const romanPrompt = document.getElementById('roman-prompt');
        const romanMeaning = document.getElementById('roman-meaning');
        const romanInput = document.getElementById('roman-input');
        const romanFeedback = document.getElementById('roman-feedback');
        const romanCheck = document.getElementById('roman-check');
        const romanShow = document.getElementById('roman-show');
        const romanNext = document.getElementById('roman-next');

        // Language detection
        function detectLanguage() {
            const browserLang = navigator.language || navigator.userLanguage;
            const langCode = browserLang.substring(0, 2);
            
            // Check if we support this language
            const supportedLanguages = ['en', 'fr'];
            if (supportedLanguages.includes(langCode)) {
                return langCode;
            }
            
            // Fallback to English
            return 'en';
        }

        // Load JSON files
        async function loadData() {
            try {
                const [vocabResponse, i18nResponse] = await Promise.all([
                    fetch('./data/vocabulary.json'),
                    fetch('./data/i18n.json')
                ]);

                if (!vocabResponse.ok || !i18nResponse.ok) {
                    throw new Error('Failed to load data files');
                }

                const vocabData = await vocabResponse.json();
                vocabulary = vocabData.words;
                i18nData = await i18nResponse.json();

                return true;
            } catch (error) {
                console.error('Error loading data:', error);
                loading.textContent = 'Error loading data. Please refresh the page.';
                return false;
            }
        }

        // Internationalization functions
        function t(key) {
            return i18nData[currentLanguage] && i18nData[currentLanguage][key] 
                ? i18nData[currentLanguage][key] 
                : i18nData.en[key] || key;
        }

        function updateI18n() {
            // Update all elements with data-i18n attribute
            document.querySelectorAll('[data-i18n]').forEach(element => {
                const key = element.getAttribute('data-i18n');
                element.textContent = t(key);
            });

            // Update placeholders
            document.querySelectorAll('[data-i18n-placeholder]').forEach(element => {
                const key = element.getAttribute('data-i18n-placeholder');
                element.placeholder = t(key);
            });

            // Update document title
            document.title = t('title');

            // Update HTML lang attribute
            document.documentElement.lang = currentLanguage;
        }

        // Language switching
        function changeLanguage(lang) {
            currentLanguage = lang;
            languageSelect.value = lang;
            localStorage.setItem('preferredLanguage', lang);
            updateI18n();
            
            // Update current word display to reflect new language
            if (vocabulary.length > 0) {
                updateWordDisplay();
            }
        }

        // Initialize the app
        async function init() {
            // Detect language or load from localStorage
            const savedLang = localStorage.getItem('preferredLanguage');
            const detectedLang = detectLanguage();
            currentLanguage = savedLang || detectedLang;

            // Load data files
            const dataLoaded = await loadData();
            if (!dataLoaded) return;

            // Set up language selector
            languageSelect.value = currentLanguage;

            // Update i18n
            updateI18n();

            // Set up event listeners
            setupEventListeners();

            // Hide loading and show app
            loading.classList.add('hidden');
            document.getElementById('hangeul-to-roman').classList.remove('hidden');

            // Load first word
            loadNewWord();
        }

        function setupEventListeners() {
            // Language selector
            languageSelect.addEventListener('change', (e) => {
                changeLanguage(e.target.value);
            });

            // Tab switching
            tabs.forEach(tab => {
                tab.addEventListener('click', (e) => {
                    switchTab(e.target.dataset.tab);
                });
            });

            // Check answer buttons
            hangeulCheck.addEventListener('click', checkHangeulAnswer);
            romanCheck.addEventListener('click', checkRomanAnswer);
            
            // Show word buttons
            hangeulShow.addEventListener('click', showHangeulAnswer);
            romanShow.addEventListener('click', showRomanAnswer);

            // Next word buttons
            hangeulNext.addEventListener('click', nextWord);
            romanNext.addEventListener('click', nextWord);
        }

        function switchTab(tabName) {
            // Update active tab
            tabs.forEach(tab => tab.classList.remove('active'));
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');

            // Update visible content
            tabContents.forEach(content => content.classList.add('hidden'));
            document.getElementById(tabName).classList.remove('hidden');

            // Update current mode
            currentMode = tabName;
            
            // Load new word for the new mode
            loadNewWord();
        }

        function loadNewWord() {
            if (vocabulary.length === 0) return;
            
            // Get random word
            currentWordIndex = Math.floor(Math.random() * vocabulary.length);
            updateWordDisplay();
        }

        function updateWordDisplay() {
            const word = vocabulary[currentWordIndex];
            const meaning = word.meaning[currentLanguage] || word.meaning.en;

            if (currentMode === 'hangeul-to-roman') {
                hangeulPrompt.textContent = word.hangeul;
                hangeulMeaning.textContent = meaning;
                hangeulInput.value = '';
                hangeulFeedback.textContent = t('instruction_check_romanization');
                hangeulFeedback.className = 'feedback neutral';
            } else {
                romanPrompt.textContent = word.romanization;
                romanMeaning.textContent = meaning;
                romanInput.value = '';
                romanFeedback.textContent = t('instruction_check_hangeul');
                romanFeedback.className = 'feedback neutral';
            }
        }

        function checkHangeulAnswer() {
            const userInput = hangeulInput.value.trim().toLowerCase();
            const correctAnswer = vocabulary[currentWordIndex].romanization.toLowerCase();

            if (userInput === '') {
                hangeulFeedback.textContent = t('feedback_enter_answer');
                hangeulFeedback.className = 'feedback neutral';
                return;
            }

            if (userInput === correctAnswer) {
                hangeulFeedback.textContent = t('feedback_correct');
                hangeulFeedback.className = 'feedback correct';
            } else {
                hangeulFeedback.textContent = t('feedback_incorrect_try_again');
                hangeulFeedback.className = 'feedback incorrect';
            }
        }

        function checkRomanAnswer() {
            const userInput = romanInput.value.trim();
            const correctAnswer = vocabulary[currentWordIndex].hangeul;

            if (userInput === '') {
                romanFeedback.textContent = t('feedback_enter_answer');
                romanFeedback.className = 'feedback neutral';
                return;
            }

            if (userInput === correctAnswer) {
                romanFeedback.textContent = t('feedback_correct');
                romanFeedback.className = 'feedback correct';
            } else {
                romanFeedback.textContent = t('feedback_incorrect_try_again');
                romanFeedback.className = 'feedback incorrect';
            }
        }

        function showHangeulAnswer() {
            const correctAnswer = vocabulary[currentWordIndex].romanization;
            hangeulFeedback.textContent = `${t('feedback_answer_is')} "${correctAnswer}"`;
            hangeulFeedback.className = 'feedback neutral';
        }

        function showRomanAnswer() {
            const correctAnswer = vocabulary[currentWordIndex].hangeul;
            romanFeedback.textContent = `${t('feedback_answer_is')} "${correctAnswer}"`;
            romanFeedback.className = 'feedback neutral';
        }

        function nextWord() {
            loadNewWord();
        }

        // Start the application
        init();
    </script>
</body>
</html>
